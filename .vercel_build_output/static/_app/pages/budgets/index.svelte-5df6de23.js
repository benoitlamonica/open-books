import{S as e,i as t,s as n,Q as l,e as s,k as r,c,a,d as o,n as i,b as u,f as h,F as d,t as f,g as m,E as v,N as $,h as p,P as g,x as b,u as y,G as k,j as E,m as I,o as D,v as w,r as x,w as P,l as V,R as C,C as A,V as j,W as S,O as B,X as N,H as O,A as T,M as R,Y as _}from"../../chunks/vendor-f155ec50.js";import{n as H,a as L,S as M,f as q,b as Y,m as U,B as z,s as F,c as G,d as J,e as Q,t as W,h as X,i as K,j as Z,o as ee,k as te,l as ne}from"../../chunks/Spinner-d90d95ed.js";import{r as le}from"../../chunks/singletons-12a22614.js";const se={69123:{name:"Lyon",nb:9,base:69380},75056:{name:"Paris",nb:20,base:75100},13055:{name:"Marseille",nb:16,base:13200}};function re(e,t){var n;return`siret?${[`q=${n={denominationUniteLegale:H(e),codeCommuneEtablissement:t,categorieJuridiqueUniteLegale:"7210"},Object.entries(n).map((([e,t])=>Array.isArray(t)?`(${t.map((t=>`${e}:${t}`)).join(" OR ")})`:`${e}:${t}`)).join(" AND ")}`,"nombre=1000"].join("&")}`}const ce={headers:{Accept:"application/json",Authorization:"Bearer f72cd59e-d5a0-3a1e-a767-9002a6ae04d2"}};function ae(e,t){const n=re(e,function(e){let t=[parseInt(e)];if(e in se){const{nb:n,base:l}=se[e];t=[...t,...Array(n).keys()].map((e=>l+e+1))}return t}(t));return L(`https://api.insee.fr/entreprises/sirene/V3/${n}`,ce).then((e=>e.etablissements))}const oe={2018:"0",2016:"1",2015:"2",2014:"3",2013:"4",2012:"5",2019:"6",2020:"7",2017:"-"};function ie(e){const{year:t}=e;var n;return`api/records/1.0/search?dataset=${[`balances-comptables-des-collectivites-et-des-etablissements-publics-locaux-avec${oe[t]}`,`q=${n=e,Object.entries(n).filter((([e,t])=>"year"!==e)).map((([e,t])=>`${e}:${Array.isArray(t)?t.join(" OR "):t}`)).join("&")}`,"rows=10000"].join("&")}`}function ue(e){const t=ie(e);return L(`https://data.economie.gouv.fr/${t}`).then((({records:e})=>e.map((e=>e.fields))))}const he=le,de=async function(e,t){return he.goto(e,t,[])};function fe(e,t,n){const l=e.slice();return l[7]=t[n],l}function me(e,t,n){const l=e.slice();return l[10]=t[n].siret,l[7]=t[n].siren,l[11]=t[n].etabl,l[12]=t[n].label,l[14]=n,l}function ve(e){return{c:k,l:k,m:k,i:k,o:k,d:k}}function $e(e){return{c:k,l:k,m:k,i:k,o:k,d:k}}function pe(e){let t,n,l;return n=new M({props:{color:"#999"}}),{c(){t=s("div"),E(n.$$.fragment),this.h()},l(e){t=c(e,"DIV",{class:!0});var l=a(t);I(n.$$.fragment,l),l.forEach(o),this.h()},h(){u(t,"class","loading svelte-g9cmc2")},m(e,s){h(e,t,s),D(n,t,null),l=!0},i(e){l||(b(n.$$.fragment,e),l=!0)},o(e){y(n.$$.fragment,e),l=!1},d(e){e&&o(t),w(n)}}}function ge(e){let t,n,l,g,b,y,k,E,I,D,w,x,P,V,C=e[7]+"",A=e[11]+"",j=(e[12]||ke)+"";function S(){return e[6](e[10])}return{c(){t=s("li"),n=s("div"),l=s("div"),g=s("span"),b=f(C),y=r(),k=s("span"),E=f(A),I=r(),D=s("div"),w=f(j),x=r(),this.h()},l(e){t=c(e,"LI",{class:!0});var s=a(t);n=c(s,"DIV",{class:!0});var r=a(n);l=c(r,"DIV",{class:!0});var u=a(l);g=c(u,"SPAN",{class:!0});var h=a(g);b=m(h,C),h.forEach(o),y=i(u),k=c(u,"SPAN",{class:!0});var d=a(k);E=m(d,A),d.forEach(o),u.forEach(o),I=i(r),D=c(r,"DIV",{class:!0});var f=a(D);w=m(f,j),f.forEach(o),r.forEach(o),x=i(s),s.forEach(o),this.h()},h(){u(g,"class","siren svelte-g9cmc2"),u(k,"class","etabl"),u(l,"class","info svelte-g9cmc2"),u(D,"class","label"),u(n,"class","svelte-g9cmc2"),u(t,"class","siret svelte-g9cmc2"),v(t,"selected",e[2]===e[10]),v(t,"main",0===e[14])},m(e,s){h(e,t,s),d(t,n),d(n,l),d(l,g),d(g,b),d(l,y),d(l,k),d(k,E),d(n,I),d(n,D),d(D,w),d(t,x),P||(V=$(n,"click",S),P=!0)},p(n,l){e=n,17&l&&C!==(C=e[7]+"")&&p(b,C),17&l&&A!==(A=e[11]+"")&&p(E,A),17&l&&j!==(j=(e[12]||ke)+"")&&p(w,j),21&l&&v(t,"selected",e[2]===e[10])},d(e){e&&o(t),P=!1,V()}}}function be(e){let t,n,l;function f(...t){return e[5](e[7],...t)}let m=e[0].filter(f),v=[];for(let s=0;s<m.length;s+=1)v[s]=ge(me(e,m,s));return{c(){t=s("li"),n=s("ul");for(let e=0;e<v.length;e+=1)v[e].c();l=r(),this.h()},l(e){t=c(e,"LI",{class:!0});var s=a(t);n=c(s,"UL",{});var r=a(n);for(let t=0;t<v.length;t+=1)v[t].l(r);r.forEach(o),l=i(s),s.forEach(o),this.h()},h(){u(t,"class","siren svelte-g9cmc2")},m(e,s){h(e,t,s),d(t,n);for(let t=0;t<v.length;t+=1)v[t].m(n,null);d(t,l)},p(t,l){if(e=t,23&l){let t;for(m=e[0].filter(f),t=0;t<m.length;t+=1){const s=me(e,m,t);v[t]?v[t].p(s,l):(v[t]=ge(s),v[t].c(),v[t].m(n,null))}for(;t<v.length;t+=1)v[t].d(1);v.length=m.length}},d(e){e&&o(t),g(v,e)}}}function ye(e){let t,n,f,m,v={ctx:e,current:null,token:null,hasCatch:!1,pending:pe,then:$e,catch:ve,blocks:[,,,]};l(n=e[3],v);let $=e[4],p=[];for(let l=0;l<$.length;l+=1)p[l]=be(fe(e,$,l));return{c(){t=s("ul"),v.block.c(),f=r();for(let e=0;e<p.length;e+=1)p[e].c();this.h()},l(e){t=c(e,"UL",{class:!0});var n=a(t);v.block.l(n),f=i(n);for(let t=0;t<p.length;t+=1)p[t].l(n);n.forEach(o),this.h()},h(){u(t,"class","Labels svelte-g9cmc2")},m(e,n){h(e,t,n),v.block.m(t,v.anchor=null),v.mount=()=>t,v.anchor=f,d(t,f);for(let l=0;l<p.length;l+=1)p[l].m(t,null);m=!0},p(s,[r]){if(e=s,v.ctx=e,8&r&&n!==(n=e[3])&&l(n,v),23&r){let n;for($=e[4],n=0;n<$.length;n+=1){const l=fe(e,$,n);p[n]?p[n].p(l,r):(p[n]=be(l),p[n].c(),p[n].m(t,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=$.length}},i(e){m||(b(v.block),m=!0)},o(e){for(let t=0;t<3;t+=1){const e=v.blocks[t];y(e)}m=!1},d(e){e&&o(t),v.block.d(),v.token=null,v=null,g(p,e)}}}const ke="commune";function Ee(e,t,n){let l,{labels:s}=t,{select:r}=t,{selected:c}=t,{loadingP:a}=t;return e.$$set=e=>{"labels"in e&&n(0,s=e.labels),"select"in e&&n(1,r=e.select),"selected"in e&&n(2,c=e.selected),"loadingP"in e&&n(3,a=e.loadingP)},e.$$.update=()=>{1&e.$$.dirty&&n(4,l=[...new Set(s.map((({siren:e})=>e)))])},[s,r,c,a,l,(e,t)=>t.siren===e,e=>r(e)]}class Ie extends e{constructor(e){super(),t(this,e,Ee,ye,n,{labels:0,select:1,selected:2,loadingP:3})}}function De(e){let t,n,l,r=q(e[2])+"";return{c(){t=s("div"),n=f(r),this.h()},l(e){t=c(e,"DIV",{class:!0,style:!0});var l=a(t);n=m(l,r),l.forEach(o),this.h()},h(){u(t,"class","value svelte-16rgqp8"),u(t,"style",l=`height: ${e[4]};`)},m(e,l){h(e,t,l),d(t,n)},p(e,s){4&s&&r!==(r=q(e[2])+"")&&p(n,r),16&s&&l!==(l=`height: ${e[4]};`)&&u(t,"style",l)},i:k,o:k,d(e){e&&o(t)}}}function we(e){let t;return{c(){t=s("i"),this.h()},l(e){t=c(e,"I",{class:!0}),a(t).forEach(o),this.h()},h(){u(t,"class","fas fa-times icon svelte-16rgqp8")},m(e,n){h(e,t,n)},p:k,i:k,o:k,d(e){e&&o(t)}}}function xe(e){let t,n;return t=new M({props:{size:"1.5"}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p:k,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function Pe(e){let t,n,l,g,k,E,I,D,w,V;const C=[xe,we,De],A=[];function j(e,t){return e[1]?0:e[5]?1:e[2]?2:-1}return~(l=j(e))&&(g=A[l]=C[l](e)),{c(){t=s("li"),n=s("div"),g&&g.c(),k=r(),E=s("h3"),I=f(e[0]),this.h()},l(l){t=c(l,"LI",{class:!0});var s=a(t);n=c(s,"DIV",{class:!0});var r=a(n);g&&g.l(r),r.forEach(o),k=i(s),E=c(s,"H3",{class:!0});var u=a(E);I=m(u,e[0]),u.forEach(o),s.forEach(o),this.h()},h(){u(n,"class","info svelte-16rgqp8"),u(E,"class","svelte-16rgqp8"),u(t,"class","Year svelte-16rgqp8"),v(t,"pending",e[1]),v(t,"unavailable",e[5]),v(t,"ready",e[6]),v(t,"selected",e[3])},m(s,r){h(s,t,r),d(t,n),~l&&A[l].m(n,null),d(t,k),d(t,E),d(E,I),D=!0,w||(V=$(t,"click",e[7]),w=!0)},p(e,[s]){let r=l;l=j(e),l===r?~l&&A[l].p(e,s):(g&&(x(),y(A[r],1,1,(()=>{A[r]=null})),P()),~l?(g=A[l],g?g.p(e,s):(g=A[l]=C[l](e),g.c()),b(g,1),g.m(n,null)):g=null),(!D||1&s)&&p(I,e[0]),2&s&&v(t,"pending",e[1]),8&s&&v(t,"selected",e[3])},i(e){D||(b(g),D=!0)},o(e){y(g),D=!1},d(e){e&&o(t),~l&&A[l].d(),w=!1,V()}}}function Ve(e,t,n){let l,{year:s}=t,{pending:r=!1}=t,{value:c=null}=t,{maxP:a}=t,{select:o=null}=t,{selected:i=!1}=t;const u=!r&&!c,h=!!c;return a&&a.then((e=>{u||setTimeout((()=>n(4,l=c/e*100+"%")),50)})),e.$$set=e=>{"year"in e&&n(0,s=e.year),"pending"in e&&n(1,r=e.pending),"value"in e&&n(2,c=e.value),"maxP"in e&&n(8,a=e.maxP),"select"in e&&n(9,o=e.select),"selected"in e&&n(3,i=e.selected)},[s,r,c,i,l,u,h,function(){h&&(null==o||o())},a,o]}class Ce extends e{constructor(e){super(),t(this,e,Ve,Pe,n,{year:0,pending:1,value:2,maxP:8,select:9,selected:3})}}function Ae(e,t,n){const l=e.slice();return l[6]=t[n],l[8]=n,l}function je(e){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Se(e){let t,n,l;function s(){return e[5](e[6])}return t=new Ce({props:{year:e[6],value:e[9],maxP:e[4],selected:e[6]===e[3],select:s}}),{c(){E(t.$$.fragment),n=r()},l(e){I(t.$$.fragment,e),n=i(e)},m(e,s){D(t,e,s),h(e,n,s),l=!0},p(n,l){e=n;const r={};2&l&&(r.year=e[6]),1&l&&(r.value=e[9]),16&l&&(r.maxP=e[4]),10&l&&(r.selected=e[6]===e[3]),6&l&&(r.select=s),t.$set(r)},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){y(t.$$.fragment,e),l=!1},d(e){w(t,e),e&&o(n)}}}function Be(e){let t,n,l;return t=new Ce({props:{year:e[6],pending:!0,maxP:e[4]}}),{c(){E(t.$$.fragment),n=r()},l(e){I(t.$$.fragment,e),n=i(e)},m(e,s){D(t,e,s),h(e,n,s),l=!0},p(e,n){const l={};2&n&&(l.year=e[6]),16&n&&(l.maxP=e[4]),t.$set(l)},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){y(t.$$.fragment,e),l=!1},d(e){w(t,e),e&&o(n)}}}function Ne(e){let t,n,s,r={ctx:e,current:null,token:null,hasCatch:!1,pending:Be,then:Se,catch:je,value:9,blocks:[,,,]};return l(n=e[0][e[8]],r),{c(){t=V(),r.block.c()},l(e){t=V(),r.block.l(e)},m(e,n){h(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,s=!0},p(t,s){e=t,r.ctx=e,1&s&&n!==(n=e[0][e[8]])&&l(n,r)||C(r,e,s)},i(e){s||(b(r.block),s=!0)},o(e){for(let t=0;t<3;t+=1){const e=r.blocks[t];y(e)}s=!1},d(e){e&&o(t),r.block.d(e),r.token=null,r=null}}}function Oe(e){let t,n,l=e[1],r=[];for(let s=0;s<l.length;s+=1)r[s]=Ne(Ae(e,l,s));const i=e=>y(r[e],1,1,(()=>{r[e]=null}));return{c(){t=s("ul");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=c(e,"UL",{class:!0});var n=a(t);for(let t=0;t<r.length;t+=1)r[t].l(n);n.forEach(o),this.h()},h(){u(t,"class","Years svelte-xkyjww")},m(e,l){h(e,t,l);for(let n=0;n<r.length;n+=1)r[n].m(t,null);n=!0},p(e,[n]){if(31&n){let s;for(l=e[1],s=0;s<l.length;s+=1){const c=Ae(e,l,s);r[s]?(r[s].p(c,n),b(r[s],1)):(r[s]=Ne(c),r[s].c(),b(r[s],1),r[s].m(t,null))}for(x(),s=l.length;s<r.length;s+=1)i(s);P()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)b(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)y(r[t]);n=!1},d(e){e&&o(t),g(r,e)}}}function Te(e,t,n){let l,{valuePs:s}=t,{years:r}=t,{select:c}=t,{selected:a}=t;return e.$$set=e=>{"valuePs"in e&&n(0,s=e.valuePs),"years"in e&&n(1,r=e.years),"select"in e&&n(2,c=e.select),"selected"in e&&n(3,a=e.selected)},e.$$.update=()=>{1&e.$$.dirty&&n(4,l=Promise.all(s).then((e=>{const t=e.filter((e=>e));return Math.max(...t)})))},[s,r,c,a,l,e=>c(e)]}class Re extends e{constructor(e){super(),t(this,e,Te,Oe,n,{valuePs:0,years:1,select:2,selected:3})}}var _e=A(void 0),He=A(void 0),Le=A(void 0),Me=j([He,_e],(([e,t])=>{if(e&&t)return Y(e,t)}));function qe(e){return{c:k,l:k,m:k,p:k,d:k}}function Ye(e){let t,n,l,r;return{c(){t=s("a"),n=s("i"),this.h()},l(e){t=c(e,"A",{href:!0,download:!0,class:!0});var l=a(t);n=c(l,"I",{class:!0}),a(n).forEach(o),l.forEach(o),this.h()},h(){u(n,"class","fas fa-file-download svelte-3cyy5m"),u(t,"href",l=e[2].url),u(t,"download",r=e[2].file),u(t,"class","svelte-3cyy5m")},m(e,l){h(e,t,l),d(t,n)},p(e,n){1&n&&l!==(l=e[2].url)&&u(t,"href",l),1&n&&r!==(r=e[2].file)&&u(t,"download",r)},d(e){e&&o(t)}}}function Ue(e){return{c:k,l:k,m:k,p:k,d:k}}function ze(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!1,pending:Ue,then:Ye,catch:qe,value:2};return l(n=e[0],r),{c(){t=s("div"),r.block.c(),this.h()},l(e){t=c(e,"DIV",{class:!0});var n=a(t);r.block.l(n),n.forEach(o),this.h()},h(){u(t,"class","Csv svelte-3cyy5m")},m(e,n){h(e,t,n),r.block.m(t,r.anchor=null),r.mount=()=>t,r.anchor=null},p(t,[s]){e=t,r.ctx=e,1&s&&n!==(n=e[0])&&l(n,r)||C(r,e,s)},i:k,o:k,d(e){e&&o(t),r.block.d(),r.token=null,r=null}}}function Fe(e,t,n){let l,{data:s}=t;return e.$$set=e=>{"data"in e&&n(1,s=e.data)},e.$$.update=()=>{2&e.$$.dirty&&n(0,l=U(s))},[l,s]}class Ge extends e{constructor(e){super(),t(this,e,Fe,ze,n,{data:1})}}function Je(e,t,n){const l=e.slice();return l[3]=t[n].label,l[4]=t[n].select,l}function Qe(e){let t,n;return{c(){t=s("div"),n=f(e[1]),this.h()},l(l){t=c(l,"DIV",{class:!0});var s=a(t);n=m(s,e[1]),s.forEach(o),this.h()},h(){u(t,"class","current svelte-74381w")},m(e,l){h(e,t,l),d(t,n)},p(e,t){2&t&&p(n,e[1])},d(e){e&&o(t)}}}function We(e){let t,n,l,v,g,b,y,k=e[3]+"";return{c(){t=s("div"),n=f(k),l=r(),v=s("i"),g=r(),this.h()},l(e){t=c(e,"DIV",{class:!0});var s=a(t);n=m(s,k),l=i(s),v=c(s,"I",{class:!0}),a(v).forEach(o),g=i(s),s.forEach(o),this.h()},h(){u(v,"class","fas fa-caret-right next svelte-74381w"),u(t,"class","step svelte-74381w")},m(s,r){h(s,t,r),d(t,n),d(t,l),d(t,v),d(t,g),b||(y=$(t,"click",(function(){S(e[4])&&e[4].apply(this,arguments)})),b=!0)},p(t,l){e=t,1&l&&k!==(k=e[3]+"")&&p(n,k)},d(e){e&&o(t),b=!1,y()}}}function Xe(e){let t,n,l,f=e[1]&&Qe(e),m=e[0],v=[];for(let s=0;s<m.length;s+=1)v[s]=We(Je(e,m,s));return{c(){t=s("div"),f&&f.c(),n=r(),l=s("div");for(let e=0;e<v.length;e+=1)v[e].c();this.h()},l(e){t=c(e,"DIV",{class:!0});var s=a(t);f&&f.l(s),n=i(s),l=c(s,"DIV",{class:!0});var r=a(l);for(let t=0;t<v.length;t+=1)v[t].l(r);r.forEach(o),s.forEach(o),this.h()},h(){u(l,"class","steps svelte-74381w"),u(t,"class","path svelte-74381w")},m(e,s){h(e,t,s),f&&f.m(t,null),d(t,n),d(t,l);for(let t=0;t<v.length;t+=1)v[t].m(l,null)},p(e,[s]){if(e[1]?f?f.p(e,s):(f=Qe(e),f.c(),f.m(t,n)):f&&(f.d(1),f=null),1&s){let t;for(m=e[0],t=0;t<m.length;t+=1){const n=Je(e,m,t);v[t]?v[t].p(n,s):(v[t]=We(n),v[t].c(),v[t].m(l,null))}for(;t<v.length;t+=1)v[t].d(1);v.length=m.length}},i:k,o:k,d(e){e&&o(t),f&&f.d(),g(v,e)}}}function Ke(e,t,n){let l;var s;let{steps:r}=t;return e.$$set=e=>{"steps"in e&&n(0,r=e.steps)},e.$$.update=()=>{5&e.$$.dirty&&n(1,l=null===n(2,s=r.pop())||void 0===s?void 0:s.label)},[r,l,s]}class Ze extends e{constructor(e){super(),t(this,e,Ke,Xe,n,{steps:0})}}function et(e){let t,n,l,g,b,y,E,I,D,w,x,P,V,C,A,j,S,N,O,T,R=q(e[0])+"",_=q(e[1])+"";return{c(){t=s("div"),n=s("div"),l=s("div"),g=s("div"),b=f(R),E=r(),I=s("h4"),D=f("Recettes"),w=r(),x=s("div"),P=s("div"),V=s("div"),C=f(_),j=r(),S=s("h4"),N=f("Dépenses"),this.h()},l(e){t=c(e,"DIV",{class:!0});var s=a(t);n=c(s,"DIV",{class:!0});var r=a(n);l=c(r,"DIV",{class:!0});var u=a(l);g=c(u,"DIV",{class:!0,style:!0});var h=a(g);b=m(h,R),h.forEach(o),u.forEach(o),E=i(r),I=c(r,"H4",{class:!0});var d=a(I);D=m(d,"Recettes"),d.forEach(o),r.forEach(o),w=i(s),x=c(s,"DIV",{class:!0});var f=a(x);P=c(f,"DIV",{class:!0});var v=a(P);V=c(v,"DIV",{class:!0,style:!0});var $=a(V);C=m($,_),$.forEach(o),v.forEach(o),j=i(f),S=c(f,"H4",{class:!0});var p=a(S);N=m(p,"Dépenses"),p.forEach(o),f.forEach(o),s.forEach(o),this.h()},h(){u(g,"class","value svelte-1505gru"),u(g,"style",y=e[4](e[0])),v(g,"not-hover",e[3]&&e[3]!==z.CREDIT),u(l,"class","value-container svelte-1505gru"),u(I,"class","svelte-1505gru"),u(n,"class","credit svelte-1505gru"),u(V,"class","value svelte-1505gru"),u(V,"style",A=e[4](e[1])),v(V,"not-hover",e[3]&&e[3]!==z.DEBIT),u(P,"class","value-container svelte-1505gru"),u(S,"class","svelte-1505gru"),u(x,"class","debit svelte-1505gru"),u(t,"class","debit-credit svelte-1505gru")},m(s,r){h(s,t,r),d(t,n),d(n,l),d(l,g),d(g,b),d(n,E),d(n,I),d(I,D),d(t,w),d(t,x),d(x,P),d(P,V),d(V,C),d(x,j),d(x,S),d(S,N),O||(T=[$(g,"mouseenter",e[6]),$(g,"mouseleave",e[7]),$(n,"click",e[8]),$(V,"mouseenter",e[9]),$(V,"mouseleave",e[10]),$(x,"click",e[11])],O=!0)},p(e,[t]){1&t&&R!==(R=q(e[0])+"")&&p(b,R),17&t&&y!==(y=e[4](e[0]))&&u(g,"style",y),8&t&&v(g,"not-hover",e[3]&&e[3]!==z.CREDIT),2&t&&_!==(_=q(e[1])+"")&&p(C,_),18&t&&A!==(A=e[4](e[1]))&&u(V,"style",A),8&t&&v(V,"not-hover",e[3]&&e[3]!==z.DEBIT)},i:k,o:k,d(e){e&&o(t),O=!1,B(T)}}}function tt(e,t,n){let l,s,r,{credit:c}=t,{debit:a}=t,{select:o}=t;return e.$$set=e=>{"credit"in e&&n(0,c=e.credit),"debit"in e&&n(1,a=e.debit),"select"in e&&n(2,o=e.select)},e.$$.update=()=>{3&e.$$.dirty&&n(5,l=Math.max(a,c)),32&e.$$.dirty&&n(4,s=e=>{const t=e/l;return`\n    width:${100*t}%;\n    height:${100*t}%;\n    font-size: ${t}em;\n    `})},[c,a,o,r,s,l,()=>n(3,r=z.CREDIT),()=>n(3,r=void 0),()=>o(z.CREDIT),()=>n(3,r=z.DEBIT),()=>n(3,r=void 0),()=>o(z.DEBIT)]}class nt extends e{constructor(e){super(),t(this,e,tt,et,n,{credit:0,debit:1,select:2})}}function lt(e){let t;return{c(){t=s("i"),this.h()},l(e){t=c(e,"I",{class:!0}),a(t).forEach(o),this.h()},h(){u(t,"class","fas fa-ellipsis-h")},m(e,n){h(e,t,n)},d(e){e&&o(t)}}}function st(e){let t,n,l,g,b,y,E,I,D,w,x,P,V,C,A,j,S,B=`${q(e[0])}`,O=`${N(".0%")(e[1])}`,T=e[5]&&lt();return{c(){t=s("div"),n=s("div"),l=s("h3"),g=f(e[3]),b=r(),T&&T.c(),y=r(),E=s("div"),I=s("span"),D=f(B),w=r(),x=s("span"),P=f(O),V=r(),C=s("div"),this.h()},l(s){t=c(s,"DIV",{class:!0});var r=a(t);n=c(r,"DIV",{class:!0});var u=a(n);l=c(u,"H3",{class:!0});var h=a(l);g=m(h,e[3]),b=i(h),T&&T.l(h),h.forEach(o),y=i(u),E=c(u,"DIV",{class:!0});var d=a(E);I=c(d,"SPAN",{class:!0});var f=a(I);D=m(f,B),f.forEach(o),w=i(d),x=c(d,"SPAN",{class:!0});var v=a(x);P=m(v,O),v.forEach(o),d.forEach(o),u.forEach(o),V=i(r),C=c(r,"DIV",{class:!0,style:!0}),a(C).forEach(o),r.forEach(o),this.h()},h(){u(l,"class","svelte-8ob999"),u(I,"class","value svelte-8ob999"),u(x,"class","percentage"),u(E,"class","values svelte-8ob999"),u(n,"class","labels svelte-8ob999"),u(C,"class","background svelte-8ob999"),u(C,"style",A=`width: ${100*e[2]}%`),u(t,"class","bar svelte-8ob999"),v(t,"clickable",e[5])},m(s,r){h(s,t,r),d(t,n),d(n,l),d(l,g),d(l,b),T&&T.m(l,null),d(n,y),d(n,E),d(E,I),d(I,D),d(E,w),d(E,x),d(x,P),d(t,V),d(t,C),j||(S=$(t,"click",e[6]),j=!0)},p(e,[n]){8&n&&p(g,e[3]),e[5]?T||(T=lt(),T.c(),T.m(l,null)):T&&(T.d(1),T=null),1&n&&B!==(B=`${q(e[0])}`)&&p(D,B),2&n&&O!==(O=`${N(".0%")(e[1])}`)&&p(P,O),4&n&&A!==(A=`width: ${100*e[2]}%`)&&u(C,"style",A),32&n&&v(t,"clickable",e[5])},i:k,o:k,d(e){e&&o(t),T&&T.d(),j=!1,S()}}}function rt(e,t,n){let l,{value:s}=t,{percentage:r}=t,{width:c}=t,{label:a}=t,{handleClick:o}=t;return e.$$set=e=>{"value"in e&&n(0,s=e.value),"percentage"in e&&n(1,r=e.percentage),"width"in e&&n(2,c=e.width),"label"in e&&n(3,a=e.label),"handleClick"in e&&n(4,o=e.handleClick)},e.$$.update=()=>{16&e.$$.dirty&&n(5,l=!!o)},[s,r,c,a,o,l,()=>null==o?void 0:o()]}class ct extends e{constructor(e){super(),t(this,e,rt,st,n,{value:0,percentage:1,width:2,label:3,handleClick:4})}}function at(e,t,n){const l=e.slice();return l[3]=t[n].label,l[4]=t[n].value,l[5]=t[n].handleClick,l}function ot(e){let t,n;return t=new ct({props:{label:e[3],value:e[4],percentage:e[4]/e[2],width:e[4]/e[1],handleClick:e[5]}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p(e,n){const l={};1&n&&(l.label=e[3]),1&n&&(l.value=e[4]),5&n&&(l.percentage=e[4]/e[2]),3&n&&(l.width=e[4]/e[1]),1&n&&(l.handleClick=e[5]),t.$set(l)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function it(e){let t,n,l=e[0],r=[];for(let s=0;s<l.length;s+=1)r[s]=ot(at(e,l,s));const i=e=>y(r[e],1,1,(()=>{r[e]=null}));return{c(){t=s("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=c(e,"DIV",{class:!0});var n=a(t);for(let t=0;t<r.length;t+=1)r[t].l(n);n.forEach(o),this.h()},h(){u(t,"class","chart svelte-1tuxdri")},m(e,l){h(e,t,l);for(let n=0;n<r.length;n+=1)r[n].m(t,null);n=!0},p(e,[n]){if(7&n){let s;for(l=e[0],s=0;s<l.length;s+=1){const c=at(e,l,s);r[s]?(r[s].p(c,n),b(r[s],1)):(r[s]=ot(c),r[s].c(),b(r[s],1),r[s].m(t,null))}for(x(),s=l.length;s<r.length;s+=1)i(s);P()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)b(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)y(r[t]);n=!1},d(e){e&&o(t),g(r,e)}}}function ut(e,t,n){let l,s,{values:r}=t;return e.$$set=e=>{"values"in e&&n(0,r=e.values)},e.$$.update=()=>{1&e.$$.dirty&&n(2,l=F(r,"value")),1&e.$$.dirty&&n(1,s=Math.max(...r.map((({value:e})=>e))))},[r,s,l]}class ht extends e{constructor(e){super(),t(this,e,ut,it,n,{values:0})}}function dt(e){let t,n;return t=new Ze({props:{steps:e[3]}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p(e,n){const l={};8&n&&(l.steps=e[3]),t.$set(l)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function ft(e){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function mt(e){let t,n,l=e[19]&&vt(e);return{c(){l&&l.c(),t=V()},l(e){l&&l.l(e),t=V()},m(e,s){l&&l.m(e,s),h(e,t,s),n=!0},p(e,n){e[19]?l?(l.p(e,n),1&n&&b(l,1)):(l=vt(e),l.c(),b(l,1),l.m(t.parentNode,t)):l&&(x(),y(l,1,1,(()=>{l=null})),P())},i(e){n||(b(l),n=!0)},o(e){y(l),n=!1},d(e){l&&l.d(e),e&&o(t)}}}function vt(e){let t,n;return t=new Ge({props:{data:e[19]}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p(e,n){const l={};1&n&&(l.data=e[19]),t.$set(l)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function $t(e){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function pt(e){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function gt(e){let t,n,l,s,c;const a=[kt,yt,bt],u=[];function d(e,t){return e[18]?e[2]?e[6]?2:-1:1:0}~(t=d(e))&&(n=u[t]=a[t](e));let f=e[18]&&Et(e);return{c(){n&&n.c(),l=r(),f&&f.c(),s=V()},l(e){n&&n.l(e),l=i(e),f&&f.l(e),s=V()},m(e,n){~t&&u[t].m(e,n),h(e,l,n),f&&f.m(e,n),h(e,s,n),c=!0},p(e,r){let c=t;t=d(e),t===c?~t&&u[t].p(e,r):(n&&(x(),y(u[c],1,1,(()=>{u[c]=null})),P()),~t?(n=u[t],n?n.p(e,r):(n=u[t]=a[t](e),n.c()),b(n,1),n.m(l.parentNode,l)):n=null),e[18]?f?f.p(e,r):(f=Et(e),f.c(),f.m(s.parentNode,s)):f&&(f.d(1),f=null)},i(e){c||(b(n),c=!0)},o(e){y(n),c=!1},d(e){~t&&u[t].d(e),e&&o(l),f&&f.d(e),e&&o(s)}}}function bt(e){let t,n,l,v,$,g=q(e[18].main)+"";return v=new ht({props:{values:e[6]}}),{c(){t=s("div"),n=f(g),l=r(),E(v.$$.fragment),this.h()},l(e){t=c(e,"DIV",{class:!0});var s=a(t);n=m(s,g),s.forEach(o),l=i(e),I(v.$$.fragment,e),this.h()},h(){u(t,"class","main svelte-1e52ag5")},m(e,s){h(e,t,s),d(t,n),h(e,l,s),D(v,e,s),$=!0},p(e,t){(!$||32&t)&&g!==(g=q(e[18].main)+"")&&p(n,g);const l={};64&t&&(l.values=e[6]),v.$set(l)},i(e){$||(b(v.$$.fragment,e),$=!0)},o(e){y(v.$$.fragment,e),$=!1},d(e){e&&o(t),e&&o(l),w(v,e)}}}function yt(e){let t,n;return t=new nt({props:{credit:e[18].credit,debit:e[18].debit,select:e[7]}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p(e,n){const l={};32&n&&(l.credit=e[18].credit),32&n&&(l.debit=e[18].debit),t.$set(l)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function kt(e){let t,n;return{c(){t=s("div"),n=f("Aucun budget"),this.h()},l(e){t=c(e,"DIV",{class:!0});var l=a(t);n=m(l,"Aucun budget"),l.forEach(o),this.h()},h(){u(t,"class","none svelte-1e52ag5")},m(e,l){h(e,t,l),d(t,n)},p:k,i:k,o:k,d(e){e&&o(t)}}}function Et(e){let t,n,l=e[18].nomen+"";return{c(){t=s("div"),n=f(l),this.h()},l(e){t=c(e,"DIV",{class:!0});var s=a(t);n=m(s,l),s.forEach(o),this.h()},h(){u(t,"class","nomen svelte-1e52ag5")},m(e,l){h(e,t,l),d(t,n)},p(e,t){32&t&&l!==(l=e[18].nomen+"")&&p(n,l)},d(e){e&&o(t)}}}function It(e){let t,n;return t=new M({props:{color:"#333",size:"3"}}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p:k,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function Dt(e){let t,n,g,k,E,I,D,w,V,A,j,S,B,N=e[4]&&dt(e),O={ctx:e,current:null,token:null,hasCatch:!1,pending:$t,then:mt,catch:ft,value:19,blocks:[,,,]};l(D=e[0],O);let T={ctx:e,current:null,token:null,hasCatch:!1,pending:It,then:gt,catch:pt,value:18,blocks:[,,,]};return l(A=e[5],T),{c(){t=s("div"),n=s("header"),g=s("h3"),k=f(e[1]),E=r(),N&&N.c(),I=r(),O.block.c(),w=r(),V=s("div"),T.block.c(),this.h()},l(l){t=c(l,"DIV",{class:!0});var s=a(t);n=c(s,"HEADER",{class:!0});var r=a(n);g=c(r,"H3",{class:!0});var u=a(g);k=m(u,e[1]),u.forEach(o),E=i(r),N&&N.l(r),I=i(r),O.block.l(r),r.forEach(o),w=i(s),V=c(s,"DIV",{class:!0});var h=a(V);T.block.l(h),h.forEach(o),s.forEach(o),this.h()},h(){u(g,"class","svelte-1e52ag5"),v(g,"clickable",e[3].length>0),u(n,"class","svelte-1e52ag5"),u(V,"class","values svelte-1e52ag5"),u(t,"class","summary svelte-1e52ag5")},m(l,s){h(l,t,s),d(t,n),d(n,g),d(g,k),d(n,E),N&&N.m(n,null),d(n,I),O.block.m(n,O.anchor=null),O.mount=()=>n,O.anchor=null,d(t,w),d(t,V),T.block.m(V,T.anchor=null),T.mount=()=>V,T.anchor=null,j=!0,S||(B=$(g,"click",e[8]),S=!0)},p(t,[s]){e=t,(!j||2&s)&&p(k,e[1]),8&s&&v(g,"clickable",e[3].length>0),e[4]?N?(N.p(e,s),16&s&&b(N,1)):(N=dt(e),N.c(),b(N,1),N.m(n,I)):N&&(x(),y(N,1,1,(()=>{N=null})),P()),O.ctx=e,1&s&&D!==(D=e[0])&&l(D,O)||C(O,e,s),T.ctx=e,32&s&&A!==(A=e[5])&&l(A,T)||C(T,e,s)},i(e){j||(b(N),b(O.block),b(T.block),j=!0)},o(e){y(N);for(let t=0;t<3;t+=1){const e=O.blocks[t];y(e)}for(let t=0;t<3;t+=1){const e=T.blocks[t];y(e)}j=!1},d(e){e&&o(t),N&&N.d(),O.block.d(),O.token=null,O=null,T.block.d(),T.token=null,T=null,S=!1,B()}}}function wt(e,t,n){let l,s,r,c,a,o,i;O(e,Me,(e=>n(10,c=e))),O(e,_e,(e=>n(4,a=e))),O(e,He,(e=>n(11,o=e))),O(e,G,(e=>n(12,i=e)));var u=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(s,r){function c(e){try{o(l.next(e))}catch(t){r(t)}}function a(e){try{o(l.throw(e))}catch(t){r(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}o((l=l.apply(e,t||[])).next())}))};let h,d,{budgetP:f}=t,{year:m}=t,v=z.DEBIT;const $={};function p(e){n(2,v=e),He.set(void 0)}function g(e){He.set(e)}function b(e,t,n){return u(this,void 0,void 0,(function*(){let l=$[t];if(!l){const s=yield function(e,t,n){const l=function(e,t,n){let l="";return"M14"===t&&(!n||n>=3500?l="_COM_SUP3500":n<3500?l="_COM_500_3500":n<500&&(l="_COM_INF500")),[e,t,`${t}${l}.xml`].join("/")}(e,t,n);return L(`https://raw.githubusercontent.com/iOiurson/plans-de-compte/main/${l}`)}(e,t,n);l=null==d?void 0:d(s),$[t]=l}return l}))}return T((()=>u(void 0,void 0,void 0,(function*(){d=X})))),e.$$set=e=>{"budgetP"in e&&n(0,f=e.budgetP),"year"in e&&n(1,m=e.year)},e.$$.update=()=>{4097&e.$$.dirty&&f.then((e=>u(void 0,void 0,void 0,(function*(){if(e){const{year:t,nomen:n}=e;Le.set(e);const l=yield b(t,n,null==i?void 0:i.population),s=l&&J(e.records,l);_e.set(s)}})))),2064&e.$$.dirty&&n(3,h=o&&a?Q(o).map((e=>{const t=Y(e,a),{short:n,label:l}=t;return{label:n||l,select:()=>g(e)}})):[]),12&e.$$.dirty&&n(3,h=v?[{label:W[v],select:()=>p(v)},...h]:[]),1040&e.$$.dirty&&n(9,l=a&&Object.values(c?c.subTree:a)),516&e.$$.dirty&&n(6,s=null==l?void 0:l.map((e=>({label:e.label,value:e[v],handleClick:e.subTree&&(()=>g(e.code))}))).sort(((e,t)=>t.value-e.value))),1029&e.$$.dirty&&n(5,r=f.then((e=>{if(e){const t=v&&(c?c[v]:e[v]);return{debit:e.obnetdeb,credit:e.obnetcre,nomen:e.nomen,main:t}}})))},[f,m,v,h,a,r,s,p,function(){n(2,v=void 0),He.set(void 0)},l,c,o,i]}class xt extends e{constructor(e){super(),t(this,e,wt,Dt,n,{budgetP:0,year:1})}}function Pt(e){let t;return document.title=t=`Budgets pour ${e[2]}`,{c:k,l:k,m:k,p(e,n){4&n&&t!==(t=`Budgets pour ${e[2]}`)&&(document.title=t)},d:k}}function Vt(e){let t,n=e[25]&&function(e){return document.title=`Budgets pour ${e[2]} (${e[25].departement.code})`,{c:k,l:k,m:k,d:k}}(e);return{c(){n&&n.c(),t=V()},l(e){n&&n.l(e),t=V()},m(e,l){n&&n.m(e,l),h(e,t,l)},p:k,d(e){n&&n.d(e),e&&o(t)}}}function Ct(e){let t;return document.title=t=`Budgets pour ${e[2]}`,{c:k,l:k,m:k,p(e,n){4&n&&t!==(t=`Budgets pour ${e[2]}`)&&(document.title=t)},d:k}}function At(e){let t,n;return{c(){t=s("h2"),n=f(e[4]),this.h()},l(l){t=c(l,"H2",{class:!0});var s=a(t);n=m(s,e[4]),s.forEach(o),this.h()},h(){u(t,"class","svelte-1u2u6o1")},m(e,l){h(e,t,l),d(t,n)},p(e,t){16&t&&p(n,e[4])},d(e){e&&o(t)}}}function jt(e){let t,n,l=e[26]+"";return{c(){t=s("div"),n=f(l),this.h()},l(e){t=c(e,"DIV",{style:!0});var s=a(t);n=m(s,l),s.forEach(o),this.h()},h(){_(t,"color","red")},m(e,l){h(e,t,l),d(t,n)},p:k,i:k,o:k,d(e){e&&o(t)}}}function St(e){let t,n=e[25]&&function(e){let t,n,l=`${e[25].departement.code} - ${e[25].departement.nom}`;return{c(){t=s("div"),n=f(l)},l(e){t=c(e,"DIV",{});var s=a(t);n=m(s,l),s.forEach(o)},m(e,l){h(e,t,l),d(t,n)},p:k,d(e){e&&o(t)}}}(e);return{c(){n&&n.c(),t=V()},l(e){n&&n.l(e),t=V()},m(e,l){n&&n.m(e,l),h(e,t,l)},p(e,t){e[25]&&n.p(e,t)},i:k,o:k,d(e){n&&n.d(e),e&&o(t)}}}function Bt(e){let t,n;return t=new M({}),{c(){E(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,l){D(t,e,l),n=!0},p:k,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){w(t,e)}}}function Nt(e){let t,n,v,$,g,k,x,P,A,j,S,B,N,O,T,_,H,L,M,q,Y,U,z,F={ctx:e,current:null,token:null,hasCatch:!0,pending:Ct,then:Vt,catch:Pt,value:25};l(e[9],F);let G=e[4]&&At(e),J={ctx:e,current:null,token:null,hasCatch:!0,pending:Bt,then:St,catch:jt,value:25,error:26,blocks:[,,,]};return l(e[9],J),H=new Ie({props:{labels:e[6],loadingP:e[10],selected:e[0],select:e[7]}}),q=new Re({props:{years:_t,valuePs:e[5],selected:e[1],select:e[8]}}),U=new xt({props:{year:e[1],budgetP:e[3]}}),{c(){t=V(),F.block.c(),n=r(),v=s("header"),$=s("a"),g=s("i"),k=r(),x=s("div"),P=s("div"),A=s("h1"),j=f(e[2]),S=r(),G&&G.c(),B=r(),N=s("div"),J.block.c(),O=r(),T=s("div"),_=s("menu"),E(H.$$.fragment),L=r(),M=s("div"),E(q.$$.fragment),Y=r(),E(U.$$.fragment),this.h()},l(l){const s=R('[data-svelte="svelte-m4fhm1"]',document.head);t=V(),F.block.l(s),s.forEach(o),n=i(l),v=c(l,"HEADER",{class:!0});var r=a(v);$=c(r,"A",{class:!0,href:!0});var u=a($);g=c(u,"I",{class:!0}),a(g).forEach(o),u.forEach(o),k=i(r),x=c(r,"DIV",{class:!0});var h=a(x);P=c(h,"DIV",{class:!0});var d=a(P);A=c(d,"H1",{class:!0});var f=a(A);j=m(f,e[2]),f.forEach(o),S=i(d),G&&G.l(d),d.forEach(o),B=i(h),N=c(h,"DIV",{class:!0});var p=a(N);J.block.l(p),p.forEach(o),h.forEach(o),r.forEach(o),O=i(l),T=c(l,"DIV",{class:!0});var b=a(T);_=c(b,"MENU",{class:!0});var y=a(_);I(H.$$.fragment,y),y.forEach(o),L=i(b),M=c(b,"DIV",{class:!0});var E=a(M);I(q.$$.fragment,E),Y=i(E),I(U.$$.fragment,E),E.forEach(o),b.forEach(o),this.h()},h(){u(g,"class","fas fa-book-open"),u($,"class","home svelte-1u2u6o1"),u($,"href","/"),u(A,"class","svelte-1u2u6o1"),u(P,"class","labels svelte-1u2u6o1"),u(N,"class","departement svelte-1u2u6o1"),u(x,"class","info svelte-1u2u6o1"),u(v,"class","svelte-1u2u6o1"),u(_,"class","svelte-1u2u6o1"),u(M,"class","dataviz svelte-1u2u6o1"),u(T,"class","content svelte-1u2u6o1")},m(e,l){d(document.head,t),F.block.m(document.head,F.anchor=null),F.mount=()=>t.parentNode,F.anchor=t,h(e,n,l),h(e,v,l),d(v,$),d($,g),d(v,k),d(v,x),d(x,P),d(P,A),d(A,j),d(P,S),G&&G.m(P,null),d(x,B),d(x,N),J.block.m(N,J.anchor=null),J.mount=()=>N,J.anchor=null,h(e,O,l),h(e,T,l),d(T,_),D(H,_,null),d(T,L),d(T,M),D(q,M,null),d(M,Y),D(U,M,null),z=!0},p(t,[n]){C(F,e=t,n),(!z||4&n)&&p(j,e[2]),e[4]?G?G.p(e,n):(G=At(e),G.c(),G.m(P,null)):G&&(G.d(1),G=null),C(J,e,n);const l={};64&n&&(l.labels=e[6]),1&n&&(l.selected=e[0]),H.$set(l);const s={};32&n&&(s.valuePs=e[5]),2&n&&(s.selected=e[1]),q.$set(s);const r={};2&n&&(r.year=e[1]),8&n&&(r.budgetP=e[3]),U.$set(r)},i(e){z||(b(J.block),b(H.$$.fragment,e),b(q.$$.fragment,e),b(U.$$.fragment,e),z=!0)},o(e){for(let t=0;t<3;t+=1){const e=J.blocks[t];y(e)}y(H.$$.fragment,e),y(q.$$.fragment,e),y(U.$$.fragment,e),z=!1},d(e){o(t),F.block.d(),F.token=null,F=null,e&&o(n),e&&o(v),G&&G.d(),J.block.d(),J.token=null,J=null,e&&o(O),e&&o(T),w(H),w(q),w(U)}}}var Ot=function(e,t,n,l){return new(n||(n=Promise))((function(s,r){function c(e){try{o(l.next(e))}catch(t){r(t)}}function a(e){try{o(l.throw(e))}catch(t){r(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}o((l=l.apply(e,t||[])).next())}))};const Tt=(new Date).getFullYear(),Rt=Tt-1,_t=[...Array(Tt-2012+1).keys()].map((e=>e+2012));function Ht({page:{query:e}}){return Ot(this,void 0,void 0,(function*(){let t=e.get("name"),n=e.get("insee"),l=e.get("siret"),s=e.get("sirens"),r=e.get("year"),c=null==s?void 0:s.split(","),a=parseInt(r)||Rt;if(!l||!c){const e=yield ae(t,n);c=[...new Set(e.map((({siren:e})=>e)))];l=e.filter((e=>e.etablissementSiege)).map((e=>e.siret)).sort()[0]}return{props:{sirens:c,currentSiret:l,currentYear:a,insee:n,name:t}}}))}function Lt(e,t,n){let l,s,r,c,a,o,i,u,h;O(e,G,(e=>n(19,h=e))),this&&this.__awaiter;let{sirens:d}=t,{currentSiret:f}=t,{currentYear:m}=t,{insee:v}=t,{name:$}=t,p={};const g=h?Promise.resolve(h):K(v).then((e=>(G.set(e),e)));let b=_t.map((e=>ue({ident:[f],year:e}).catch((()=>[])).then((t=>{const l=Z({city:$,siret:f,year:e,records:t}),s=ne(f,e);return n(13,p[s]=l,p),l}))));const y=[..._t].reverse().map((e=>ue({siren:d,year:e}).catch((()=>[])).then((t=>ee(t).map((({siret:t,records:l})=>{const s=Z({city:$,siret:t,year:e,records:l}),r=ne(t,e);return t!==f&&n(13,p[r]=s,p),s})))))),k=[...b,...y],E=Promise.all(k);return e.$$set=e=>{"sirens"in e&&n(11,d=e.sirens),"currentSiret"in e&&n(0,f=e.currentSiret),"currentYear"in e&&n(1,m=e.currentYear),"insee"in e&&n(12,v=e.insee),"name"in e&&n(2,$=e.name)},e.$$.update=()=>{8192&e.$$.dirty&&n(17,l=function(e){return Object.values(p).find((t=>t&&t.siret===e))}),139267&e.$$.dirty&&n(15,s=function(){const e=ne(f,m),t=p[e]||l(f);return null==t?void 0:t.label}),8192&e.$$.dirty&&n(18,r=[...new Set(Object.values(p).filter((e=>e)).map((e=>e.siret)))].sort()),401410&e.$$.dirty&&n(6,c=r.map((e=>{const t=ne(e,m);return p[t]||l(e)})).filter((e=>e))),16384&e.$$.dirty&&n(5,a=b.map((e=>e.then((e=>e&&e.obnetcre))))),2&e.$$.dirty&&n(16,o=_t.findIndex((e=>e===m))),81920&e.$$.dirty&&n(3,i=b[o]),32768&e.$$.dirty&&n(4,u=s())},[f,m,$,i,u,a,c,function(e){const t=te({name:$,insee:v,siret:e,sirens:d,year:m});de(t),n(14,b=_t.map((t=>{const n=ne(e,t);return Promise.resolve(p[n])})))},function(e){const t=te({name:$,insee:v,siret:f,sirens:d,year:e});de(t)},g,E,d,v,p,b,s,o,l,r]}class Mt extends e{constructor(e){super(),t(this,e,Lt,Nt,n,{sirens:11,currentSiret:0,currentYear:1,insee:12,name:2})}}export{Mt as default,Ht as load};
